<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>EMIS Survey Application</title>
  <!-- Google Font for a modern look -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet">
  <style>
    /* Global Styles */
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background: #f7f9fc;
      color: #333;
    }
    .container {
      max-width: 1200px;
      margin: 40px auto;
      padding: 20px;
    }
    h1, h2, h3, h4 {
      margin-bottom: 10px;
      color: #007BFF;
    }
    p {
      margin: 5px 0;
      line-height: 1.6;
    }
    /* Card/Page Styling */
    .page {
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      margin-bottom: 30px;
    }
    .hidden {
      display: none;
    }
    /* Section Styling */
    .section {
      margin-bottom: 20px;
      padding: 15px;
      background: #f1f5f9;
      border-left: 4px solid #007BFF;
      border-radius: 4px;
    }
    .section label.include {
      font-weight: 500;
      display: block;
      margin-bottom: 8px;
    }
    /* Inner content wrapper for internal inputs/text */
    .inner-content {
      margin-top: 10px;
      padding-left: 10px;
      border-left: 2px solid #ccc;
    }
    .inline-input {
      margin: 5px 0;
      padding: 6px;
      width: auto;
      font-size: 14px;
    }
    textarea {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }
    /* Button Styling */
    button {
      background: #007BFF;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }
    button:hover {
      background: #0056b3;
    }
    /* Main Tabs Styling */
    .tabs {
      display: flex;
      flex-wrap: wrap;
      border-bottom: 2px solid #eee;
      margin-bottom: 20px;
    }
    .tabs button {
      background: none;
      border: none;
      padding: 10px 15px;
      margin-right: 5px;
      cursor: pointer;
      font-weight: 500;
      font-size: 16px;
      color: blue;
    }
    .tabs button.active {
      border-bottom: 3px solid #007BFF;
      color: #007BFF;
    }
    /* Report Styling */
    .report-output {
      background: #ffffff;
      border: 1px solid #007BFF;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-family: 'Roboto', sans-serif;
      color: #333;
      line-height: 1.6;
    }
    /* Added spacing for paragraphs inside the report output */
    .report-output p {
      margin-bottom: 15px;
    }
    /* Report page button container */
    .report-buttons {
      text-align: center;
      margin-top: 20px;
    }
    /* Bottom button container on page2 */
    .page2-buttons {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Technical Objectives Page -->
    <div id="page1" class="page">
      <h1>Technical Objectives Survey</h1>
      <form id="techObjectivesForm">
        <div class="section">
          <label>
            <input type="checkbox" id="obj1">
            Facilitate continuous energy management and increased operational efficiency
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj2" onchange="togglePercentage()">
            Enable the organization to reduce portfolio energy use by - 
          </label>
          <input type="text" id="reductionPercentage" placeholder="Enter percentage" class="inline-input hidden">
          <span> percent</span>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj3">
            Automate energy performance analysis using an energy information system
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj4">
            Perform automated fault detection and diagnostics (FDD) for the HVAC system
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj5">
            Achieve automated system optimization with the EMIS software performing supervisory control to supplement the building automation system (BAS)
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj6">
            Track the impact of energy efficiency projects, and measure and verify savings
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj7">
            Track and manage peak demand
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj8">
            Produce reports for energy and utility management, operations, and maintenance
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj9">
            Support implementation of ISO 50001 Ready
          </label>
        </div>
        <div class="section">
          <label>
            <input type="checkbox" id="obj10">
            Manage GHG emission monitoring and subsequent reporting
          </label>
        </div>
        <button type="button" onclick="showPage('page2')">Next</button>
      </form>
    </div>

    <!-- EMIS Specifications Page -->
    <div id="page2" class="page hidden">
      <h1>EMIS Specifications Survey</h1>
      <div class="tabs">
        <button type="button" class="active" onclick="openTab('tab1', event)">Data Integration</button>
        <button type="button" onclick="openTab('tab2', event)">Utility Bill Analytics</button>
        <button type="button" onclick="openTab('tab3', event)">Interval Meter Data Analytics</button>
        <button type="button" onclick="openTab('tab4', event)">System Data Analytics</button>
        <button type="button" onclick="openTab('tab5', event)">Automated System Optimization</button>
        <button type="button" onclick="openTab('tab6', event)">Project Management and Reporting</button>
        <button type="button" onclick="openTab('tab7', event)">IT Requirements</button>
        <button type="button" onclick="openTab('tab8', event)">Technical Warranty, Support and Training</button>
      </div>

      <!-- Tab 1: Data Integration -->
      <div id="tab1" class="tab-content">
        <!-- 1.1 Utility data integration -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_1" onchange="toggleInnerContent(this)">
            1.1 Utility data integration
          </label>
          <div class="inner-content hidden">
            <p>The technology will provide the capability to integrate utility meter data from existing systems:</p>
            <div>
              <label><input type="checkbox" id="utility_electricity_tab1"> Electricity</label><br>
              <label><input type="checkbox" id="utility_naturalGas_tab1"> Natural Gas</label><br>
              <label><input type="checkbox" id="utility_propane_tab1"> Propane</label><br>
              <label><input type="checkbox" id="utility_steam_tab1"> Steam</label><br>
              <label><input type="checkbox" id="utility_chilledWater_tab1"> Chilled Water</label><br>
              <label><input type="checkbox" id="utility_water_tab1"> Water</label><br>
              <label><input type="checkbox" id="utility_wasteWater_tab1"> Waste Water</label><br>
              <label><input type="checkbox" id="utility_compressedAir_tab1"> Compressed Air</label><br>
              <label><input type="checkbox" id="utility_renewableEnergy_tab1"> Renewable Energy</label>
            </div>
          </div>
        </div>
        <!-- 1.2 Interval sub-meter data integration -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_2" onchange="toggleInnerContent(this)">
            1.2 Interval sub-meter data integration
          </label>
          <div class="inner-content hidden">
            <p>* The technology will integrate with new and existing meters and monitoring systems from an interval meter and/or meters with pulse outputs. Where it is necessary to take advantage of existing metering data, the technology will integrate with the following systems for whole facility meters and/or submeters:</p>
            <div>
              <label>SPECIFY THE SUBMETERS:</label>
              <input type="text" id="submeters_1_2" class="inline-input" placeholder="Enter submeter details">
              <button type="button" onclick="addSubmeter()">Add</button>
              <ul id="submetersList" style="margin-left:20px;"></ul>
            </div>
            <p>* The desired data collection interval will be OPTIONS [hourly or sub-hourly (e.g., 15-minute data)].</p>
            <div>
              <label><input type="radio" name="interval_1_2" value="Hourly" checked onchange="toggleMinutesInput()"> Hourly</label><br>
              <label><input type="radio" name="interval_1_2" value="Sub-hourly" onchange="toggleMinutesInput()"> Sub-hourly</label>
              <span id="minutesInputSpan" class="hidden">
                Specify minutes: <input type="text" id="subhourlyMinutes" class="inline-input" placeholder="e.g., 5">
              </span>
            </div>
            <p>&nbsp;</p>
            <p>* Data should be available for analysis in real or near-real time through a continuous and automated data acquisition process.</p>
            <p>* The technology will have the capability to consolidate meter readings to create virtual meter points. In other words, it can add and subtract the readings from multiple meters at the same interval, to produce a calculated time series of energy use.</p>
            <p>* The technology will be able to upload and store a minimum history of 5 years of energy use or other data from standard spreadsheet or text file formats.</p>
            <p>* The technology will have the capacity to store at least 5 years of data, trended at intervals up to 15 minutes for analysis, reporting, and visualization.</p>
            <p>* The technology will have the ability to parse out data cluster displays into coincident time intervals ranging from 10 minutes to 1 year.</p>
          </div>
        </div>
        <!-- 1.3 Building automation system (BAS) data integration -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_3" onchange="toggleInnerContent(this)">
            1.3 Building automation system (BAS) data integration
          </label>
          <div class="inner-content hidden">
            <p>The technology will extract data from the building control systems for Fault Detection and Diagnostics (FDD) functions:</p>
            <p>* The data collection interval will be selected to meet the needs of the FDD software and is compatible with BAS trending, with 15-minute interval data being the most implemented. Change of value and/or slower polling rates may be needed to reduce network burden on the control system, and the effect of data collection interval on network speed will be determined during FDD setup. Slower or faster polling rates may also be implemented based on the type of fault (e.g., hunting and cycling faults may need one- to five-minute interval data).</p>
            <p>* Integration with non-legacy vintages of BAS providers will occur via common protocols such as BACnet and Modbus, or through the BAS vendor’s gateway. If the BAS does not support BACnet, a data gateway or protocol converter will need to be installed by the EMIS vendor.</p>
            <p>&nbsp;</p>
            <p>* BAS data will be integrated as follows:</p>
            <p>**These data include:</p>
            <div>
              <label><input type="checkbox" id="bas_chillerBoiler_1_3"> chiller/boiler plant data</label><br>
              <label><input type="checkbox" id="bas_airHandler_1_3"> air handler data</label><br>
              <label><input type="checkbox" id="bas_zoneDevice_1_3"> zone device data</label>
            </div>
            <p>&nbsp;</p>
            <p>**Integration will include but not be limited to CHECKBOX:</p>
            <div>
              <label><input type="checkbox" id="bas_energyMeter_1_3"> energy meter data already connected into the BAS</label><br>
              <label><input type="checkbox" id="bas_equipmentStatus_1_3"> equipment status</label><br>
              <label><input type="checkbox" id="bas_setpoints_1_3"> setpoints</label><br>
              <label><input type="checkbox" id="bas_valveSignals_1_3"> valve/damper control signals</label><br>
              <label><input type="checkbox" id="bas_fanSpeed_1_3"> fan speed</label><br>
              <label><input type="checkbox" id="bas_airFlow_1_3"> air flow rate</label><br>
              <label><input type="checkbox" id="bas_pumpFlow_1_3"> pump water flow rate</label><br>
              <label><input type="checkbox" id="bas_temperatures_1_3"> air and water temperatures</label>
            </div>
            <p>&nbsp;</p>
            <p>* Near-real time data polling or end of day batch uploads to the EMIS are acceptable.</p>
            <p>* The data integration will not adversely affect the speed of the existing BAS control or visualization functions.</p>
          </div>
        </div>
        <!-- 1.4 Additional monitoring required or preferred -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_4" onchange="toggleInnerContent(this)">
            1.4 Additional monitoring required or preferred
          </label>
          <div class="inner-content hidden">
            <textarea id="additionalMonitoring" style="height:160px;">
Additional metering and monitoring may include the following:

· Major energy end uses (panel level): Switchgear panel, etc.
· Equipment level energy end uses: chiller, boiler, cooling towers, pumps, compressors, air handlers, major electromotors, etc. 
· Functional area/zones of building/plant energy end uses: chiller plant, compressed air system, etc.
· Additional building automation system or process control points
            </textarea>
          </div>
        </div>
        <!-- 1.5 Metadata / data tagging -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_5" onchange="toggleInnerContent(this)">
            1.5 Metadata / data tagging
          </label>
          <div class="inner-content hidden">
            <p>The use of standard naming conventions and a metadata schema (which may be referred to as ‘data tags’) improves the ability of the EMIS to consistently analyze, visualize, and derive value from operational data. A metadata schema will be selected for the EMIS project, defining at a minimum:</p>
            <p>• a data dictionary for all terms used in the schema;</p>
            <p>• a data taxonomy, providing categories and subcategories for the defined terms;</p>
            <p>&nbsp;</p>
            <p>The specific version of the metadata schema should be noted, as well as noting whether the schema is an adaptation or extension of another existing schema.</p>
            <p>The EMIS vendor will provide appropriate metadata for all data integrated with the EMIS, in alignment with the schema or tagging system selected for the project.</p>
          </div>
        </div>
        <!-- 1.6 Other data sources and APIs -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_6" onchange="toggleInnerContent(this)">
            1.6 Other data sources and APIs
          </label>
          <div class="inner-content hidden">
            <p>* The software platform may need to integrate with other software platforms used by the facility to operate and manage.</p>
            <textarea id="otherDataSources" style="height:180px;">
* The software platform must have the ability to collect dynamic and static data from multiple sources (e.g., BACnet, Modbus, OPC, CSV, RDBMS, and SQL).
* The technology will integrate with multiple external data sources such as local or on-site weather stations or third-party weather providers. Degree-days will be calculated automatically and charted for inclusion in year-to-year or month-to-month energy comparisons. 
* The technology will integrate with existing lighting control and plug control systems so these data sources are available for analysis and diagnostics. [List the lighting control and/or plug load control systems.]
* The technology will integrate with the owner’s CMMS. [Indicate the CMMS vendor.]
* The technology will integrate with existing IoT-based sensing so these data sources are available for analysis and diagnostics. [List the sensing technologies and communication protocols.]
* Provision of an API to support integration of data and fault findings with the third-party applications such as business intelligence software or other accounting systems.
            </textarea>
          </div>
        </div>
        <!-- 1.7 Data validation -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_1_7" onchange="toggleInnerContent(this)">
            1.7 Data validation
          </label>
          <div class="inner-content hidden">
            <p>* The data connection to the EMIS will be validated by the EMIS vendor. In case of a data connection interruption, the data should be stored locally for at least two weeks of hourly data, or one week of sub-hourly data (e.g., 15-minute or 5-minute data).</p>
            <p>* The technology will detect meter and sensor data quality issues such as gaps, spikes, and flat-lines, and the technology provider will have an option or service to automatically fill and/or correct data.</p>
            <p>* The EMIS vendor will help to identify inaccurate data.</p>
            <p>* The EMIS vendor will address insufficient data collection intervals, false negative and false positive diagnostics, dropped communications, and erroneous metadata tagging.</p>
          </div>
        </div>
      </div>

      <!-- Tab 2: Utility Bill Analytics -->
      <div id="tab2" class="tab-content hidden">
        <!-- 2.1 Utility bill management -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_2_1" onchange="toggleInnerContent(this)">
            2.1 Utility bill management
          </label>
          <div class="inner-content hidden">
            <p>* The technology will provide the capability to allocate utility costs to different tenants or occupant groups sharing a building, to enable recharges and tenant billing.</p>
            <p>* The technology will provide capabilities for savings analysis and comparison across a building portfolio through benchmarking, deriving energy use intensity, aligning bills with a calendar month, and normalizing usage based on weather data using standard protocols such as IPMVP Option C.</p>
          </div>
        </div>
        <!-- 2.2 Utility budgeting -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_2_2" onchange="toggleInnerContent(this)">
            2.2 Utility budgeting
          </label>
          <div class="inner-content hidden">
            <p>* The technology will chart and report energy costs against budget, indicating surplus/deficit.</p>
            <p>* The technology will include custom utility tariffs for energy cost and demand calculations.</p>
          </div>
        </div>
        <!-- 2.3 Greenhouse gas (GHG) tracking -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_2_3" onchange="toggleInnerContent(this)">
            2.3 Greenhouse gas (GHG) tracking
          </label>
          <div class="inner-content hidden">
            <p>* The technology will calculate, monitor, and report GHG emissions associated with facility energy use. The technology will supply recommended GHG conversion factors from a referenceable source, and the software will allow the users to enter their own conversion factors.</p>
            <p>* Greenhouse gas calculations will account for on-site renewables, where relevant.</p>
          </div>
        </div>
      </div>

      <!-- Tab 3: Interval Meter Data Analytics -->
      <div id="tab3" class="tab-content hidden">
        <!-- 3.1 Energy consumption tracking -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_3_1" onchange="toggleInnerContent(this)">
            3.1 Energy consumption tracking
          </label>
          <div class="inner-content hidden">
            <p>* The technology will track and provide flexible charting capabilities for multiple meters on an hourly or sub hourly (e.g., 15-minute) basis.</p>
            <textarea id="energyConsumptionTracking" style="height:130px;">
o	Whole-building level: electricity, gas, water, steam, etc. 
o	End-use submetered level: Pumping system, Air Compressors, HVAC, lighting, etc.
o	Equipment submetered level: chiller, boiler, cooling tower, pump, etc.
o	Renewable energy sources: Solar photovoltaic, biogas, etc.
            </textarea>
            <p>&nbsp;</p>
            <p>* Energy cost tracking</p>
            <p>o	The technology will calculate and provide visualizations of near real-time/daily/monthly and historic energy costs.</p>
            <p>o	The technology will use facility-specific tariffs in $/energy unit.</p>
            <p>&nbsp;</p>
            <p>* Energy unit conversion</p>
            <p>o	The technology will have the ability to normalize the data according to factors that are known to affect energy consumption, such as production rates, floor area, hours of operation, heating degree days, and cooling degree days.</p>
            <p>o	The technology will have the capability to convert, display, and report energy use in total GJ and additional environmental metrics such as CO2 equivalent.</p>
          </div>
        </div>
        <!-- 3.2 Energy performance analysis -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_3_2" onchange="toggleInnerContent(this)">
            3.2 Energy performance analysis
          </label>
          <div class="inner-content hidden">
            <p>* Time series load profiling</p>
            <p>o	The technology will provide plots of at least 168-hour periods of hourly (or more frequent) interval energy usage versus time.</p>
            <p>o	The technology will provide options to select the time period and data points that are plotted.</p>
            <p>o	The technology will allow multiple user-selected data points to be plotted on a single chart or graph.</p>
            <p>&nbsp;</p>
            <p>* Benchmarking</p>
            <p>Benchmarking using the following meter-level key performance indicators (KPIs) will be included in the EMIS for the following metrics. The technology will allow the user to add custom KPIs and custom normalization factors. The benchmarks will be configured to allow for comparison to the prior [day/week/month/year].</p>
            <p>* Baseline energy consumption modeling</p>
            <p>o	The technology will characterize and predict the typical or expected energy usage based on key drivers such as weather (degree days or outside air temperature), production, time of day/week, and other variables.</p>
            <p>o	The baseline will be used for energy savings calculations, near-future load predictions, energy use comparisons, and energy anomaly detection.</p>
            <p>o	The technology has the capability to set up multiple baselines, e.g., prior year and a corporate goal baseline.</p>
            <p>&nbsp;</p>
            <p>* Energy anomaly detection</p>
            <p>o	The technology will identify and flag unexpectedly high or low energy use at the whole-facility and each submeter.</p>
            <p>o	The technology will allow for energy anomaly detection thresholds to be user-defined.</p>
            <p>o	The technology will provide the ability to track energy anomalies (duration and persistence) to facilitate response and resolution.</p>
            <p>&nbsp;</p>
            <p>* Building energy dashboards and reports</p>
            <p>o	The technology provider will provide a public-facing configurable dashboard display for occupants and visitors to view owner-defined aspects of energy consumed in the facility, including energy use intensity, and cumulative savings over time.</p>
            <p>o	The technology provider will provide an operator-facing or energy manager-facing configurable dashboard display to view building energy performance.</p>
            <p>o	The technology provider will provide all necessary hardware, software, and connectivity for users to create their own shareable reports.</p>
            <p>&nbsp;</p>
            <p>* Demand monitoring</p>
            <p>o	The technology will provide daily/monthly/annual peak load monitoring.</p>
            <p>o	The technology will provide notification through e-mail, or text message to an individual and/or group of recipients when the demand for critical metered loads passes a threshold.</p>
          </div>
        </div>
      </div>

      <!-- Tab 4: System Data Analytics -->
      <div id="tab4" class="tab-content hidden">
        <!-- 4.1 Fault and Optimization Opportunity Detection -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_1" onchange="toggleInnerContent(this)">
            4.1 Fault and Optimization Opportunity Detection
          </label>
          <div class="inner-content hidden">
            <p>* The technology will provide fault and optimization opportunity detection capabilities.</p>
          </div>
        </div>
        <!-- 4.2 Fault and Opportunity Diagnosis -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_2" onchange="toggleInnerContent(this)">
            4.2 Fault and Opportunity Diagnosis
          </label>
          <div class="inner-content hidden">
            <p>* The technology will diagnose faults and identify opportunities for improvement.</p>
          </div>
        </div>
        <!-- 4.3 FDD Configuration -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_3" onchange="toggleInnerContent(this)">
            4.3 FDD Configuration
          </label>
          <div class="inner-content hidden">
            <p>* The technology will support configuration of FDD settings.</p>
          </div>
        </div>
        <!-- 4.4 Fault management and FDD results presentation -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_4" onchange="toggleInnerContent(this)">
            4.4 Fault management and FDD results presentation
          </label>
          <div class="inner-content hidden">
            <p>* The technology will present fault management data and FDD results in a user‑friendly format.</p>
          </div>
        </div>
        <!-- 4.5 Work order management -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_5" onchange="toggleInnerContent(this)">
            4.5 Work order management
          </label>
          <div class="inner-content hidden">
            <p>* The technology will integrate with work order systems for managing detected faults.</p>
          </div>
        </div>
        <!-- 4.6 System-level diagnostic supports -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_4_6" onchange="toggleInnerContent(this)">
            4.6 System-level diagnostic supports
          </label>
          <div class="inner-content hidden">
            <p>* The technology will provide system‑level diagnostic support capabilities.</p>
          </div>
        </div>
      </div>

      <!-- Tab 5: Automated System Optimization -->
      <div id="tab5" class="tab-content hidden">
        <!-- 5.1 HVAC performance optimization -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_5_1" onchange="toggleInnerContent(this)">
            5.1 HVAC performance optimization
          </label>
          <div class="inner-content hidden">
            <p>* The technology will optimize HVAC performance through automated controls.</p>
          </div>
        </div>
        <!-- 5.2 Peak demand charge minimization -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_5_2" onchange="toggleInnerContent(this)">
            5.2 Peak demand charge minimization
          </label>
          <div class="inner-content hidden">
            <p>* The technology will minimize peak demand charges by adjusting loads in real time.</p>
          </div>
        </div>
        <!-- 5.3 Provision of grid services -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_5_3" onchange="toggleInnerContent(this)">
            5.3 Provision of grid services
          </label>
          <div class="inner-content hidden">
            <p>* The technology will enable the provision of grid services where applicable.</p>
          </div>
        </div>
        <!-- 5.4 Other supervisory control strategies -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_5_4" onchange="toggleInnerContent(this)">
            5.4 Other supervisory control strategies
          </label>
          <div class="inner-content hidden">
            <p>* The technology will support additional supervisory control strategies as required.</p>
          </div>
        </div>
      </div>

      <!-- Tab 6: Project Management and Reporting -->
      <div id="tab6" class="tab-content hidden">
        <!-- 6.1 Project management and verification of savings -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_6_1" onchange="toggleInnerContent(this)">
            6.1 Project management and verification of savings
          </label>
          <div class="inner-content hidden">
            <p>* The technology will provide the capability to log and track the status of energy efficiency projects (e.g., start, ongoing, finish) and personnel assigned. It will allow users to annotate charts and displays with key events and store those annotations.</p>
            <p>* The technology will provide measurement and verification (M&amp;V) capabilities in accordance with the International Protocol for Measurement and Verification Protocol (IPMVP) Option C or other industry standards, such as ASHRAE Guideline 14. The baseline model type should be described in the proposal, and preferably adhere to transparent/documented model specifications. Additional requirements include:</p>
            <p>o Provision of baseline model fitness metrics (e.g., NMBE, CV[RMSE], R2)</p>
            <p>o Ability to create multiple baseline models for a single meter</p>
            <p>o Ability to perform M&amp;V using monthly and interval data</p>
            <p>o Ability to convert savings to common units (e.g., GJ, $) and normalize (e.g., GJ/sq ft/yr or GJ/unit of production)</p>
            <p>o Ability to use ambient temperature data within the baseline models</p>
            <p>o Ability to acquire other independent variable data, such as production rate, hours of operation, etc. These data may be entered manually or acquired from a facility-level system</p>
            <p>&nbsp;</p>
            <p>* The technology will provide the ability to express savings for each discrete project or in aggregate at the whole-building meter or submeter level, for a defined pre- and post- period or as a cumulative aggregated total. Output and charting requirements include: time-series charts including actual and predicted energy use, cumulative sum of energy savings charts (CUSUM), and energy savings report tables.</p>
            <p>* The technology will provide capabilities to support savings analysis using IPMVP Option B.</p>
          </div>
        </div>
        <!-- 6.2 Notification, reporting and data export -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_6_2" onchange="toggleInnerContent(this)">
            6.2 Notification, reporting and data export
          </label>
          <div class="inner-content hidden">
            <p>* The technology will provide customizable notification schemes including: work order generation, e-mail, phone, text message, to individual and/or group recipients for data quality alerting, anomaly detection, and fault detection.</p>
            <p>* The technology will provide year-over-year energy, cost, and/or equipment health and performance reports in a format specified or acceptable by the facility.</p>
            <p>* The technology will provide users the ability to create and save custom reports.</p>
            <p>* The technology will export reports to the following file formats [specify which]:</p>
            <label><input type="checkbox" id="export_pdf"> .pdf</label><br>
            <label><input type="checkbox" id="export_doc"> .doc/.docx</label><br>
            <label><input type="checkbox" id="export_html"> .html</label>
            <p>&nbsp;</p>
            <p>* The technology will allow users to export data (all, or selected points or totalizations) to the following file formats:</p>
            <p>o .xlsx/.xls</p>
            <p>o .csv</p>
            <p>o .xml</p>
          </div>
        </div>
      </div>

      <!-- Tab 7: IT Requirements -->
      <div id="tab7" class="tab-content hidden">
        <!-- 7.1 Data storage and backup -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_1" onchange="toggleInnerContent(this)">
            7.1 Data storage and backup
          </label>
          <div class="inner-content hidden">
            <p>* The technology will ensure robust data storage and backup solutions.</p>
          </div>
        </div>
        <!-- 7.2 Software hosting and data ownership -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_2" onchange="toggleInnerContent(this)">
            7.2 Software hosting and data ownership
          </label>
          <div class="inner-content hidden">
            <p>* Hosting arrangements and data ownership protocols will be clearly defined.</p>
          </div>
        </div>
        <!-- 7.3 Cybersecurity -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_3" onchange="toggleInnerContent(this)">
            7.3 Cybersecurity
          </label>
          <div class="inner-content hidden">
            <p>* Robust cybersecurity measures will be incorporated.</p>
          </div>
        </div>
        <!-- 7.4 Permissions and access control -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_4" onchange="toggleInnerContent(this)">
            7.4 Permissions and access control
          </label>
          <div class="inner-content hidden">
            <p>* Role‑based permissions and secure access control will be provided.</p>
          </div>
        </div>
        <!-- 7.5 Usability -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_5" onchange="toggleInnerContent(this)">
            7.5 Usability
          </label>
          <div class="inner-content hidden">
            <p>* The technology will be designed for ease of use and intuitive operation.</p>
          </div>
        </div>
        <!-- 7.6 Networking -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_7_6" onchange="toggleInnerContent(this)">
            7.6 Networking
          </label>
          <div class="inner-content hidden">
            <p>* Networking requirements for connectivity and performance will be met.</p>
          </div>
        </div>
      </div>

      <!-- Tab 8: Technical Warranty, Support and Training -->
      <div id="tab8" class="tab-content hidden">
        <!-- 8.1 Warranty -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_8_1" onchange="toggleInnerContent(this)">
            8.1 Warranty
          </label>
          <div class="inner-content hidden">
            <p>* A defined warranty period with specified terms will be provided.</p>
          </div>
        </div>
        <!-- 8.2 Technical support -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_8_2" onchange="toggleInnerContent(this)">
            8.2 Technical support
          </label>
          <div class="inner-content hidden">
            <p>* Technical support, including service level agreements, will be offered.</p>
          </div>
        </div>
        <!-- 8.3 Training -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_8_3" onchange="toggleInnerContent(this)">
            8.3 Training
          </label>
          <div class="inner-content hidden">
            <p>* Training for end users and technical staff will be provided.</p>
          </div>
        </div>
        <!-- 8.4 Testing and Commissioning -->
        <div class="section">
          <label class="include">
            <input type="checkbox" id="include_8_4" onchange="toggleInnerContent(this)">
            8.4 Testing and Commissioning
          </label>
          <div class="inner-content hidden">
            <p>* Testing and commissioning protocols and procedures will be outlined.</p>
          </div>
        </div>
      </div>
      
      <!-- NEW: Generate Report button at the bottom of page2 -->
      <div class="page2-buttons">
        <button type="button" onclick="generateReport()">Generate Report</button>
      </div>
    </div>

    <!-- Report Output Page -->
    <div id="reportSection" class="page hidden">
      <h1>Generated Report</h1>
      <div id="reportOutput" class="report-output"></div>
      <div class="report-buttons">
        <button onclick="downloadReport()">Download Report as .doc</button>
        <button onclick="showPage('page2')">Back to Survey</button>
      </div>
    </div>
  </div>

  <script>
    // Toggle the reduction percentage textbox on Technical Objectives page
    function togglePercentage() {
      var checkbox = document.getElementById('obj2');
      var textbox = document.getElementById('reductionPercentage');
      if (checkbox.checked) {
        textbox.classList.remove('hidden');
      } else {
        textbox.classList.add('hidden');
        textbox.value = "";
      }
    }
    
    // Toggle the minutes input for 1.2 if Sub-hourly is selected
    function toggleMinutesInput() {
      var radios = document.getElementsByName('interval_1_2');
      var span = document.getElementById('minutesInputSpan');
      for (var i = 0; i < radios.length; i++) {
        if (radios[i].checked && radios[i].value === "Sub-hourly") {
          span.classList.remove('hidden');
          return;
        }
      }
      span.classList.add('hidden');
      document.getElementById('subhourlyMinutes').value = "";
    }
    
    // Show a specific page
    function showPage(pageId) {
      document.getElementById('page1').classList.add('hidden');
      document.getElementById('page2').classList.add('hidden');
      document.getElementById('reportSection').classList.add('hidden');
      document.getElementById(pageId).classList.remove('hidden');
    }
    
    // Main tab switching functionality
    function openTab(tabId, event) {
      var tabs = document.getElementsByClassName('tab-content');
      for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.add('hidden');
      }
      document.getElementById(tabId).classList.remove('hidden');
      
      var tabButtons = document.querySelectorAll('.tabs button');
      tabButtons.forEach(function(btn) {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
    }
    
    // Add submeter bullet point for 1.2
    function addSubmeter() {
      var input = document.getElementById('submeters_1_2');
      var value = input.value.trim();
      if (value !== "") {
        var ul = document.getElementById('submetersList');
        var li = document.createElement('li');
        li.textContent = value;
        ul.appendChild(li);
        input.value = "";
      }
    }
    
    // Gather which utility checkboxes were selected in 1.1
    function selectedUtilityOptions() {
      var txt = "\nSelected options: ";
      var arr = [];
      if(document.getElementById('utility_electricity_tab1').checked) arr.push("Electricity");
      if(document.getElementById('utility_naturalGas_tab1').checked) arr.push("Natural Gas");
      if(document.getElementById('utility_propane_tab1').checked) arr.push("Propane");
      if(document.getElementById('utility_steam_tab1').checked) arr.push("Steam");
      if(document.getElementById('utility_chilledWater_tab1').checked) arr.push("Chilled Water");
      if(document.getElementById('utility_water_tab1').checked) arr.push("Water");
      if(document.getElementById('utility_wasteWater_tab1').checked) arr.push("Waste Water");
      if(document.getElementById('utility_compressedAir_tab1').checked) arr.push("Compressed Air");
      if(document.getElementById('utility_renewableEnergy_tab1').checked) arr.push("Renewable Energy");
      if(arr.length === 0) return "";
      return txt + arr.join(", ");
    }
    
    // Build the text for 1.2 Interval sub-meter data integration
    function buildIntervalSubmeterText() {
      var ul = document.getElementById('submetersList');
      var bulletPoints = [];
      for (var i = 0; i < ul.children.length; i++) {
        bulletPoints.push(ul.children[i].textContent);
      }
      var intervalText = "";
      var radios = document.getElementsByName('interval_1_2');
      for(var i = 0; i < radios.length; i++) {
        if(radios[i].checked) {
          if(radios[i].value === "Hourly") {
            intervalText = "• The desired data collection interval will be hourly.";
          } else {
            var mins = document.getElementById('subhourlyMinutes').value || "5";
            intervalText = "• The desired data collection interval will be sub-hourly (e.g., " + mins + "-minute data).";
          }
          break;
        }
      }
      var text = "";
      text += "• The technology will integrate with new and existing meters and monitoring systems from an interval meter and/or meters with pulse outputs. Where it is necessary to take advantage of existing metering data, the technology will integrate with the following systems for whole facility meters and/or submeters:<br>";
      if(bulletPoints.length > 0) {
        for(var j = 0; j < bulletPoints.length; j++) {
          text += "&nbsp;&nbsp;&nbsp;o " + bulletPoints[j] + "<br>";
        }
      }
      text += intervalText + "<br>";
      text += "• Data should be available for analysis in real or near-real time through a continuous and automated data acquisition process.<br>";
      text += "• The technology will have the capability to consolidate meter readings to create virtual meter points.<br>";
      text += "• The technology will be able to upload and store a minimum history of 5 years of energy use or other data from standard spreadsheet or text file formats.<br>";
      text += "• The technology will have the capacity to store at least 5 years of data, trended at intervals up to 15 minutes for analysis, reporting, and visualization.<br>";
      text += "• The technology will have the ability to parse out data cluster displays into coincident time intervals ranging from 10 minutes to 1 year.";
      return text;
    }
    
    // Build the text for 1.3 BAS integration
    function buildBASIntegrationText() {
      var arrDataInclude = [];
      if(document.getElementById('bas_chillerBoiler_1_3').checked) arrDataInclude.push("chiller/boiler plant data");
      if(document.getElementById('bas_airHandler_1_3').checked) arrDataInclude.push("air handler data");
      if(document.getElementById('bas_zoneDevice_1_3').checked) arrDataInclude.push("zone device data");
      var arrIntegration = [];
      if(document.getElementById('bas_energyMeter_1_3').checked) arrIntegration.push("energy meter data already connected into the BAS");
      if(document.getElementById('bas_equipmentStatus_1_3').checked) arrIntegration.push("equipment status");
      if(document.getElementById('bas_setpoints_1_3').checked) arrIntegration.push("setpoints");
      if(document.getElementById('bas_valveSignals_1_3').checked) arrIntegration.push("valve/damper control signals");
      if(document.getElementById('bas_fanSpeed_1_3').checked) arrIntegration.push("fan speed");
      if(document.getElementById('bas_airFlow_1_3').checked) arrIntegration.push("air flow rate");
      if(document.getElementById('bas_pumpFlow_1_3').checked) arrIntegration.push("pump water flow rate");
      if(document.getElementById('bas_temperatures_1_3').checked) arrIntegration.push("air and water temperatures");
    
      var text = "";
      text += "• The technology will extract data from the building control systems for Fault Detection and Diagnostics (FDD) functions.<br>";
      text += "• The data collection interval will be selected to meet the needs of the FDD software and is compatible with BAS trending, with 15-minute interval data being the most implemented. Change of value and/or slower polling rates may be needed...<br>";
      text += "• Integration with non-legacy vintages of BAS providers will occur via common protocols such as BACnet and Modbus, or through the BAS vendor’s gateway.<br>";
      text += "• BAS data will be integrated as follows:<br>";
      text += "&nbsp;&nbsp;&nbsp;o These data include: " + (arrDataInclude.length > 0 ? arrDataInclude.join(", ") : "(none)") + "<br>";
      text += "&nbsp;&nbsp;&nbsp;o Integration will include but not be limited to: " + (arrIntegration.length > 0 ? arrIntegration.join(", ") : "(none)") + "<br>";
      text += "• Near-real time data polling or end of day batch uploads to the EMIS are acceptable.<br>";
      text += "• The data integration will not adversely affect the speed of the existing BAS control or visualization functions.";
      return text;
    }
    
    // Build the text for 1.4 Additional monitoring
    function buildAdditionalMonitoringText() {
      return "• Major energy end uses (panel level): Switchgear panel, etc.<br>" +
             "• Equipment level energy end uses: chiller, boiler, cooling towers, pumps, compressors, air handlers, major electromotors, etc.<br>" +
             "• Functional area/zones of building/plant energy end uses: chiller plant, compressed air system, etc.<br>" +
             "• Additional building automation system or process control points";
    }
    
    // Build the text for 3.1 Energy consumption tracking
    function build3_1Text() {
      var text = "The technology will track and provide flexible charting capabilities for multiple meters on an hourly or sub hourly (e.g., 15-minute) basis.<br>";
      var trackingText = document.getElementById('energyConsumptionTracking').value.trim();
      // Replace newlines with <br> for proper display
      trackingText = trackingText.replace(/\n/g, "<br>");
      text += trackingText + "<br><br>"; // Extra spacing after the textarea content
      text += "* Energy cost tracking<br>";
      text += "o The technology will calculate and provide visualizations of near real-time/daily/monthly and historic energy costs.<br>";
      text += "o The technology will use facility-specific tariffs in $/energy unit.<br><br>";
      text += "* Energy unit conversion<br>";
      text += "o The technology will have the ability to normalize the data according to factors that are known to affect energy consumption.<br>";
      text += "o The technology will have the capability to convert, display, and report energy use in total GJ and additional environmental metrics such as CO2 equivalent.";
      return text;
    }
    
    // Get selected export formats for reports (6.2)
    function getExportFormats() {
      var formats = [];
      if(document.getElementById('export_pdf').checked) formats.push(".pdf");
      if(document.getElementById('export_doc').checked) formats.push(".doc/.docx");
      if(document.getElementById('export_html').checked) formats.push(".html");
      return formats.join(", ");
    }
    
    // Toggle inner content display based on outer "Include" checkbox
    function toggleInnerContent(checkbox) {
      var inner = checkbox.parentElement.nextElementSibling;
      if (inner && inner.classList.contains("inner-content")) {
        if (checkbox.checked) {
          inner.classList.remove("hidden");
        } else {
          inner.classList.add("hidden");
        }
      }
    }
    
    // Generate the final formatted HTML report with nested ordered lists for indentations.
    function generateReport() {
      var report = "";
      report += "<h2 style='color:#007BFF;'>Energy Management Information Systems (EMIS)</h2>";
      report += "<p>An Energy Management Information System (EMIS) is a performance management tool that provides your organization with the information needed to enhance energy performance, manage and control energy use in relation to production, and support effective planning and decision-making. An effective EMIS contributes to continuous improvement and can drive significant energy efficiency and cost savings over time.</p>";
      report += "<p><strong>Key Elements:</strong></p><ol><li>Data capture and storage</li><li>Analysis</li><li>Reporting and notifications</li></ol>";
      report += "<p>Implementing EMIS has led to significant energy and cost savings across various Canadian industries. For example, New Gold's New Afton Mine in British Columbia implemented an EMIS to monitor over 160 energy consumption data points – achieving ISO 50001 energy certification in 2014. More references of EMIS implementations can be found in Energy management information systems - Natural Resources Canada.</p>";
      report += "<p>For your facility, which currently does not have an EMIS, it is recommended to implement a system that includes real-time monitoring, utility billing and data analytics, performance benchmarking, energy consumption forecasting, automated alerts and notifications, automated controls and optimization, energy performance reporting, and integration with production and facility systems.</p>";
      
      report += "<h3 style='color:#007BFF;'>Selected Features:</h3>";
      report += "<ul>";
      if(document.getElementById('obj1').checked) report += "<li>Facilitate continuous energy management and increased operational efficiency</li>";
      if(document.getElementById('obj2').checked) {
        var perc = document.getElementById('reductionPercentage').value || "five";
        report += "<li>Enable the organization to reduce portfolio energy use by " + perc + " percent</li>";
      }
      if(document.getElementById('obj3').checked) report += "<li>Automate energy performance analysis using an energy information system</li>";
      if(document.getElementById('obj4').checked) report += "<li>Perform automated fault detection and diagnostics (FDD) for the HVAC system</li>";
      if(document.getElementById('obj5').checked) report += "<li>Achieve automated system optimization with the EMIS software performing supervisory control to supplement the BAS</li>";
      if(document.getElementById('obj6').checked) report += "<li>Track the impact of energy efficiency projects, and measure and verify savings</li>";
      if(document.getElementById('obj7').checked) report += "<li>Track and manage peak demand</li>";
      if(document.getElementById('obj8').checked) report += "<li>Produce reports for energy and utility management, operations, and maintenance</li>";
      if(document.getElementById('obj9').checked) report += "<li>Support implementation of ISO 50001 Ready</li>";
      if(document.getElementById('obj10').checked) report += "<li>Manage GHG emission monitoring and subsequent reporting</li>";
      report += "</ul>";
      
      report += "<h3 style='color:#007BFF;'>Proposed EMIS Implementation</h3>";
      report += "<ul>";
      
      // Section 1: Data Integration
      report += "<li style='margin-bottom:10px;'><strong>1. Data Integration</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_1_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.1 Utility data integration</strong><br>" + 
                   "The technology will provide the capability to integrate utility meter data from existing systems. " + selectedUtilityOptions() + "</li>";
      }
      if(document.getElementById("include_1_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.2 Interval sub-meter data integration</strong><br>" + buildIntervalSubmeterText() + "</li>";
      }
      if(document.getElementById("include_1_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.3 Building automation system (BAS) data integration</strong><br>" + buildBASIntegrationText() + "</li>";
      }
      if(document.getElementById("include_1_4").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.4 Additional monitoring required or preferred</strong><br>" + buildAdditionalMonitoringText() + "</li>";
      }
      if(document.getElementById("include_1_5").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.5 Metadata / data tagging</strong><br>" + 
                   "* The use of standard naming conventions and a metadata schema improves the ability of the EMIS to consistently analyze and visualize data.<br>" +
                   "* A metadata schema (data tags) will be selected with a data dictionary and taxonomy." + "</li>";
      }
      if(document.getElementById("include_1_6").checked) {
         var otherText = document.getElementById('otherDataSources').value.trim();
         otherText = otherText.replace(/\n/g, "<br>");
         report += "<li style='margin-bottom:10px;'><strong>1.6 Other data sources and APIs</strong><br>" + otherText + "</li>";
      }
      if(document.getElementById("include_1_7").checked) {
         report += "<li style='margin-bottom:10px;'><strong>1.7 Data validation</strong><br>" + 
                   "* The EMIS vendor will validate the data connection and store data locally in case of interruption.<br>" +
                   "* The technology will detect and address data quality issues such as gaps, spikes, and flat-lines." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 2: Utility Bill Analytics
      report += "<li style='margin-bottom:10px;'><strong>2. Utility Bill Analytics</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_2_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>2.1 Utility bill management</strong><br>" + 
                   "* The technology will allocate utility costs to different tenants/occupant groups.<br>" +
                   "* Capabilities include savings analysis, benchmarking, and aligning bills with calendar months." + "</li>";
      }
      if(document.getElementById("include_2_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>2.2 Utility budgeting</strong><br>" + 
                   "* The technology will chart and report energy costs against budget and include custom utility tariffs." + "</li>";
      }
      if(document.getElementById("include_2_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>2.3 Greenhouse gas (GHG) tracking</strong><br>" + 
                   "* The technology will calculate, monitor, and report GHG emissions using recommended or user-entered conversion factors.<br>" +
                   "* On-site renewables will be accounted for." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 3: Interval Meter Data Analytics
      report += "<li style='margin-bottom:10px;'><strong>3. Interval Meter Data Analytics</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_3_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>3.1 Energy consumption tracking</strong><br>" + build3_1Text() + "</li>";
      }
      if(document.getElementById("include_3_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>3.2 Energy performance analysis</strong><br>" + 
                   "* The technology will provide time series load profiling, benchmarking, baseline modeling, and anomaly detection.<br>" +
                   "* Dashboards and reports will be provided for both public and operator use.<br>" +
                   "* Daily/monthly/annual peak load monitoring with notifications will be implemented." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 4: System Data Analytics
      report += "<li style='margin-bottom:10px;'><strong>4. System Data Analytics</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_4_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.1 Fault and Optimization Opportunity Detection</strong><br>" + "* The technology will provide fault and optimization opportunity detection capabilities." + "</li>";
      }
      if(document.getElementById("include_4_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.2 Fault and Opportunity Diagnosis</strong><br>" + "* The technology will diagnose faults and identify opportunities for improvement." + "</li>";
      }
      if(document.getElementById("include_4_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.3 FDD Configuration</strong><br>" + "* The technology will support configuration of FDD settings." + "</li>";
      }
      if(document.getElementById("include_4_4").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.4 Fault management and FDD results presentation</strong><br>" + "* The technology will present fault management data in a user‑friendly format." + "</li>";
      }
      if(document.getElementById("include_4_5").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.5 Work order management</strong><br>" + "* The technology will integrate with work order systems for managing detected faults." + "</li>";
      }
      if(document.getElementById("include_4_6").checked) {
         report += "<li style='margin-bottom:10px;'><strong>4.6 System-level diagnostic supports</strong><br>" + "* The technology will provide system-level diagnostic support capabilities." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 5: Automated System Optimization
      report += "<li style='margin-bottom:10px;'><strong>5. Automated System Optimization</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_5_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>5.1 HVAC performance optimization</strong><br>" + "* The technology will optimize HVAC performance through automated controls." + "</li>";
      }
      if(document.getElementById("include_5_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>5.2 Peak demand charge minimization</strong><br>" + "* The technology will minimize peak demand charges by adjusting loads in real time." + "</li>";
      }
      if(document.getElementById("include_5_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>5.3 Provision of grid services</strong><br>" + "* The technology will enable the provision of grid services where applicable." + "</li>";
      }
      if(document.getElementById("include_5_4").checked) {
         report += "<li style='margin-bottom:10px;'><strong>5.4 Other supervisory control strategies</strong><br>" + "* The technology will support additional supervisory control strategies as required." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 6: Project Management and Reporting
      report += "<li style='margin-bottom:10px;'><strong>6. Project Management and Reporting</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_6_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>6.1 Project management and verification of savings</strong><br>" + 
                   "* The technology will log and track the status of energy efficiency projects, allowing annotations on charts and displays.<br>" +
                   "* Measurement and verification (M&amp;V) capabilities in line with industry standards will be provided." + "</li>";
      }
      if(document.getElementById("include_6_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>6.2 Notification, reporting and data export</strong><br>" + 
                   "* The technology will provide customizable notification schemes (e-mail, phone, text, etc.) for alerts and fault detection.<br>" +
                   "* It will also offer year-over-year energy, cost, and performance reports, and allow users to create and save custom reports.<br>" +
                   "* The technology will export reports to the following file formats: " + getExportFormats() + "<br>" +
                   "* It will allow users to export data to: .xlsx/.xls, .csv, .xml" + "</li>";
      }
      report += "</ul></li>";
      
      // Section 7: IT Requirements
      report += "<li style='margin-bottom:10px;'><strong>7. IT Requirements</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_7_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.1 Data storage and backup</strong><br>" + "* Robust data storage and backup solutions will be ensured." + "</li>";
      }
      if(document.getElementById("include_7_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.2 Software hosting and data ownership</strong><br>" + "* Hosting arrangements and data ownership protocols will be clearly defined." + "</li>";
      }
      if(document.getElementById("include_7_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.3 Cybersecurity</strong><br>" + "* Robust cybersecurity measures will be incorporated." + "</li>";
      }
      if(document.getElementById("include_7_4").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.4 Permissions and access control</strong><br>" + "* Role‑based permissions and secure access control will be provided." + "</li>";
      }
      if(document.getElementById("include_7_5").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.5 Usability</strong><br>" + "* The technology will be designed for ease of use and intuitive operation." + "</li>";
      }
      if(document.getElementById("include_7_6").checked) {
         report += "<li style='margin-bottom:10px;'><strong>7.6 Networking</strong><br>" + "* Networking requirements for connectivity and performance will be met." + "</li>";
      }
      report += "</ul></li>";
      
      // Section 8: Technical Warranty, Support and Training
      report += "<li style='margin-bottom:10px;'><strong>8. Technical Warranty, Support and Training</strong>";
      report += "<ul style='margin-left:20px;'>";
      if(document.getElementById("include_8_1").checked) {
         report += "<li style='margin-bottom:10px;'><strong>8.1 Warranty</strong><br>" + "* A defined warranty period with specified terms will be provided." + "</li>";
      }
      if(document.getElementById("include_8_2").checked) {
         report += "<li style='margin-bottom:10px;'><strong>8.2 Technical support</strong><br>" + "* Technical support, including service level agreements, will be offered." + "</li>";
      }
      if(document.getElementById("include_8_3").checked) {
         report += "<li style='margin-bottom:10px;'><strong>8.3 Training</strong><br>" + "* Training for end users and technical staff will be provided." + "</li>";
      }
      if(document.getElementById("include_8_4").checked) {
         report += "<li style='margin-bottom:10px;'><strong>8.4 Testing and Commissioning</strong><br>" + "* Testing and commissioning protocols and procedures will be outlined." + "</li>";
      }
      report += "</ul></li>";
      
      report += "</ul>";
      document.getElementById('reportOutput').innerHTML = report;
      showPage('reportSection');
    }
    
    // Download the report as a .doc file with proper Word-readable HTML
    function downloadReport() {
      var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                   "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                   "xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>EMIS Report</title>" +
                   "<style>body { font-family: 'Roboto', sans-serif; margin: 20px; } p { margin-bottom: 15px; } ul { margin-bottom: 15px; } li { margin-bottom: 10px; }</style></head><body>";
      var footer = "</body></html>";
      var reportText = document.getElementById('reportOutput').innerHTML;
      var sourceHTML = header + reportText + footer;
      var blob = new Blob([sourceHTML], { type: "application/msword" });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = "EMIS_Report.doc";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
